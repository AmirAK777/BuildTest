import { Component, inject } from '@angular/core';
import { FormBuilder, ReactiveFormsModule, Validators } from '@angular/forms';
import { IonContent, IonHeader, IonText, IonRow, IonThumbnail, IonButton, IonInput, IonItem, IonLabel, IonToolbar, IonTitle, } from '@ionic/angular/standalone';
import { matchValidator } from '../../validators/matching.validator';
import { AuthenticationStore } from '../../store';
import * as i0 from "@angular/core";
import * as i1 from "@angular/forms";
export class ForgotPasswordComponent {
    constructor() {
        this.store = inject(AuthenticationStore);
        this.formBuilder = inject(FormBuilder);
        this.steps = this.store.steps;
        this.emailForm = this.formBuilder.group({
            email: ['', [Validators.required, Validators.email]],
        });
        this.codeForm = this.formBuilder.group({
            code: ['', [Validators.required, Validators.minLength(6)]],
        });
        this.updatePasswordForm = this.formBuilder.group({
            newPassword: ['', [Validators.required, Validators.minLength(8)]],
            confirmPassword: ['', [Validators.required]],
        }, {
            validators: [matchValidator('newPassword', 'confirmPassword')],
        });
    }
    sendVerificationCode() {
        if (this.emailForm.value.email)
            this.store.sendResetCode(this.emailForm.value.email);
    }
    verifyCode() {
        if (this.codeForm.value.code)
            this.store.verifyResetCode(this.codeForm.value.code);
    }
    updatePassword() {
        if (this.updatePasswordForm.valid &&
            this.updatePasswordForm.value.confirmPassword &&
            !this.updatePasswordForm.hasError('mismatch'))
            this.store.updatePassword(this.updatePasswordForm.value.confirmPassword);
    }
    redirectToLogin() { }
    static { this.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "18.2.13", ngImport: i0, type: ForgotPasswordComponent, deps: [], target: i0.ɵɵFactoryTarget.Component }); }
    static { this.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "17.0.0", version: "18.2.13", type: ForgotPasswordComponent, isStandalone: true, selector: "clovis-forgot-password", ngImport: i0, template: "<ion-header collapse=\"fade\">\r\n  <ion-toolbar>\r\n    <ion-row\r\n      class=\"ion-justify-content-center ion-align-items-center ion-text-center\"\r\n    >\r\n      <ion-thumbnail>\r\n        <img\r\n          alt=\"Enveloppe\"\r\n          src=\"https://res.cloudinary.com/dyewhr2lj/image/upload/v1668516112/Logo_Clovis_fxqyoh.png\"\r\n        />\r\n      </ion-thumbnail>\r\n      <p>clovis</p>\r\n    </ion-row>\r\n  </ion-toolbar>\r\n</ion-header>\r\n\r\n<ion-content class=\"ion-padding\">\r\n  @switch (steps()) { @case (1) {\r\n  <ion-text class=\"ion-text-center ion-margin\">\r\n    <h3>R\u00E9initialisation de votre mot de passe</h3>\r\n    <p>Nous vous enverrons un code de v\u00E9rification \u00E0 votre adresse email</p>\r\n  </ion-text>\r\n  <form [formGroup]=\"emailForm\" (ngSubmit)=\"sendVerificationCode()\">\r\n    <ion-item>\r\n      <ion-input\r\n        fill=\"solid\"\r\n        label=\"Email\"\r\n        labelPlacement=\"floating\"\r\n        formControlName=\"email\"\r\n        type=\"text\"\r\n      ></ion-input>\r\n    </ion-item>\r\n\r\n    <ion-button\r\n      class=\"clovis\"\r\n      [disabled]=\"emailForm.invalid\"\r\n      expand=\"block\"\r\n      type=\"submit\"\r\n      >Envoyer le code de v\u00E9rification</ion-button\r\n    >\r\n  </form>\r\n  } @case (2) {\r\n  <ion-text class=\"ion-text-center ion-margin\">\r\n    <h3>Saisissez le code \u00E0 6 chiffres que vous avec re\u00E7u par email</h3>\r\n  </ion-text>\r\n\r\n  <form [formGroup]=\"codeForm\" (ngSubmit)=\"verifyCode()\">\r\n    <ion-item>\r\n      <ion-input\r\n        fill=\"solid\"\r\n        label=\"Code de s\u00E9curit\u00E9\"\r\n        labelPlacement=\"floating\"\r\n        formControlName=\"code\"\r\n        type=\"password\"\r\n      ></ion-input>\r\n    </ion-item>\r\n\r\n    <ion-button\r\n      class=\"clovis\"\r\n      expand=\"block\"\r\n      type=\"submit\"\r\n      [disabled]=\"codeForm.invalid\"\r\n      >Valider</ion-button\r\n    >\r\n  </form>\r\n  } @case (3) {\r\n  <ion-text class=\"ion-text-center ion-margin\">\r\n    <h3>Parfait ! Saisissez votre nouveau mot de passe</h3>\r\n  </ion-text>\r\n\r\n  <form [formGroup]=\"updatePasswordForm\" (ngSubmit)=\"updatePassword()\">\r\n    <ion-item>\r\n      <ion-input\r\n        fill=\"solid\"\r\n        label=\"Nouveau mot de passe\"\r\n        labelPlacement=\"floating\"\r\n        formControlName=\"newPassword\"\r\n        type=\"password\"\r\n      ></ion-input>\r\n    </ion-item>\r\n    <ion-item>\r\n      <ion-input\r\n        fill=\"solid\"\r\n        label=\"Confirmer le mot de passe\"\r\n        labelPlacement=\"floating\"\r\n        formControlName=\"confirmPassword\"\r\n        type=\"password\"\r\n      ></ion-input>\r\n    </ion-item>\r\n\r\n    <ion-button\r\n      class=\"clovis\"\r\n      expand=\"block\"\r\n      type=\"submit\"\r\n      [disabled]=\"updatePasswordForm.invalid\"\r\n      >Valider</ion-button\r\n    >\r\n  </form>\r\n  } }\r\n</ion-content>\r\n", styles: ["ion-header ion-thumbnail{--size: 32px}ion-header p{font-family:SofiaPro,sans-serif;font-weight:600;font-size:1.1em}ion-text{font-family:SofiaPro,sans-serif}ion-text h3{font-weight:600}ion-text p{font-weight:300}ion-button{margin-top:50px}ion-input{font-family:SofiaPro,sans-serif;font-weight:500;--color: #54565c}\n"], dependencies: [{ kind: "component", type: IonToolbar, selector: "ion-toolbar", inputs: ["color", "mode"] }, { kind: "component", type: IonItem, selector: "ion-item", inputs: ["button", "color", "detail", "detailIcon", "disabled", "download", "href", "lines", "mode", "rel", "routerAnimation", "routerDirection", "target", "type"] }, { kind: "component", type: IonInput, selector: "ion-input", inputs: ["accept", "autocapitalize", "autocomplete", "autocorrect", "autofocus", "clearInput", "clearOnEdit", "color", "counter", "counterFormatter", "debounce", "disabled", "enterkeyhint", "errorText", "fill", "helperText", "inputmode", "label", "labelPlacement", "max", "maxlength", "min", "minlength", "mode", "multiple", "name", "pattern", "placeholder", "readonly", "required", "shape", "size", "spellcheck", "step", "type", "value"] }, { kind: "component", type: IonButton, selector: "ion-button", inputs: ["buttonType", "color", "disabled", "download", "expand", "fill", "form", "href", "mode", "rel", "routerAnimation", "routerDirection", "shape", "size", "strong", "target", "type"] }, { kind: "component", type: IonRow, selector: "ion-row" }, { kind: "component", type: IonText, selector: "ion-text", inputs: ["color", "mode"] }, { kind: "component", type: IonHeader, selector: "ion-header", inputs: ["collapse", "mode", "translucent"] }, { kind: "component", type: IonContent, selector: "ion-content", inputs: ["color", "fixedSlotPlacement", "forceOverscroll", "fullscreen", "scrollEvents", "scrollX", "scrollY"] }, { kind: "component", type: IonThumbnail, selector: "ion-thumbnail" }, { kind: "ngmodule", type: ReactiveFormsModule }, { kind: "directive", type: i1.ɵNgNoValidate, selector: "form:not([ngNoForm]):not([ngNativeValidate])" }, { kind: "directive", type: i1.NgControlStatus, selector: "[formControlName],[ngModel],[formControl]" }, { kind: "directive", type: i1.NgControlStatusGroup, selector: "[formGroupName],[formArrayName],[ngModelGroup],[formGroup],form:not([ngNoForm]),[ngForm]" }, { kind: "directive", type: i1.FormGroupDirective, selector: "[formGroup]", inputs: ["formGroup"], outputs: ["ngSubmit"], exportAs: ["ngForm"] }, { kind: "directive", type: i1.FormControlName, selector: "[formControlName]", inputs: ["formControlName", "disabled", "ngModel"], outputs: ["ngModelChange"] }] }); }
}
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "18.2.13", ngImport: i0, type: ForgotPasswordComponent, decorators: [{
            type: Component,
            args: [{ selector: 'clovis-forgot-password', standalone: true, imports: [
                        IonTitle,
                        IonToolbar,
                        IonLabel,
                        IonItem,
                        IonInput,
                        IonButton,
                        IonRow,
                        IonText,
                        IonHeader,
                        IonContent,
                        IonThumbnail,
                        ReactiveFormsModule,
                    ], template: "<ion-header collapse=\"fade\">\r\n  <ion-toolbar>\r\n    <ion-row\r\n      class=\"ion-justify-content-center ion-align-items-center ion-text-center\"\r\n    >\r\n      <ion-thumbnail>\r\n        <img\r\n          alt=\"Enveloppe\"\r\n          src=\"https://res.cloudinary.com/dyewhr2lj/image/upload/v1668516112/Logo_Clovis_fxqyoh.png\"\r\n        />\r\n      </ion-thumbnail>\r\n      <p>clovis</p>\r\n    </ion-row>\r\n  </ion-toolbar>\r\n</ion-header>\r\n\r\n<ion-content class=\"ion-padding\">\r\n  @switch (steps()) { @case (1) {\r\n  <ion-text class=\"ion-text-center ion-margin\">\r\n    <h3>R\u00E9initialisation de votre mot de passe</h3>\r\n    <p>Nous vous enverrons un code de v\u00E9rification \u00E0 votre adresse email</p>\r\n  </ion-text>\r\n  <form [formGroup]=\"emailForm\" (ngSubmit)=\"sendVerificationCode()\">\r\n    <ion-item>\r\n      <ion-input\r\n        fill=\"solid\"\r\n        label=\"Email\"\r\n        labelPlacement=\"floating\"\r\n        formControlName=\"email\"\r\n        type=\"text\"\r\n      ></ion-input>\r\n    </ion-item>\r\n\r\n    <ion-button\r\n      class=\"clovis\"\r\n      [disabled]=\"emailForm.invalid\"\r\n      expand=\"block\"\r\n      type=\"submit\"\r\n      >Envoyer le code de v\u00E9rification</ion-button\r\n    >\r\n  </form>\r\n  } @case (2) {\r\n  <ion-text class=\"ion-text-center ion-margin\">\r\n    <h3>Saisissez le code \u00E0 6 chiffres que vous avec re\u00E7u par email</h3>\r\n  </ion-text>\r\n\r\n  <form [formGroup]=\"codeForm\" (ngSubmit)=\"verifyCode()\">\r\n    <ion-item>\r\n      <ion-input\r\n        fill=\"solid\"\r\n        label=\"Code de s\u00E9curit\u00E9\"\r\n        labelPlacement=\"floating\"\r\n        formControlName=\"code\"\r\n        type=\"password\"\r\n      ></ion-input>\r\n    </ion-item>\r\n\r\n    <ion-button\r\n      class=\"clovis\"\r\n      expand=\"block\"\r\n      type=\"submit\"\r\n      [disabled]=\"codeForm.invalid\"\r\n      >Valider</ion-button\r\n    >\r\n  </form>\r\n  } @case (3) {\r\n  <ion-text class=\"ion-text-center ion-margin\">\r\n    <h3>Parfait ! Saisissez votre nouveau mot de passe</h3>\r\n  </ion-text>\r\n\r\n  <form [formGroup]=\"updatePasswordForm\" (ngSubmit)=\"updatePassword()\">\r\n    <ion-item>\r\n      <ion-input\r\n        fill=\"solid\"\r\n        label=\"Nouveau mot de passe\"\r\n        labelPlacement=\"floating\"\r\n        formControlName=\"newPassword\"\r\n        type=\"password\"\r\n      ></ion-input>\r\n    </ion-item>\r\n    <ion-item>\r\n      <ion-input\r\n        fill=\"solid\"\r\n        label=\"Confirmer le mot de passe\"\r\n        labelPlacement=\"floating\"\r\n        formControlName=\"confirmPassword\"\r\n        type=\"password\"\r\n      ></ion-input>\r\n    </ion-item>\r\n\r\n    <ion-button\r\n      class=\"clovis\"\r\n      expand=\"block\"\r\n      type=\"submit\"\r\n      [disabled]=\"updatePasswordForm.invalid\"\r\n      >Valider</ion-button\r\n    >\r\n  </form>\r\n  } }\r\n</ion-content>\r\n", styles: ["ion-header ion-thumbnail{--size: 32px}ion-header p{font-family:SofiaPro,sans-serif;font-weight:600;font-size:1.1em}ion-text{font-family:SofiaPro,sans-serif}ion-text h3{font-weight:600}ion-text p{font-weight:300}ion-button{margin-top:50px}ion-input{font-family:SofiaPro,sans-serif;font-weight:500;--color: #54565c}\n"] }]
        }] });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZm9yZ290LXBhc3N3b3JkLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uLy4uL3Byb2plY3RzL2F1dGgtZmVhdHVyZXMvc3JjL2xpYi9wYWdlcy9mb3Jnb3QtcGFzc3dvcmQvZm9yZ290LXBhc3N3b3JkLmNvbXBvbmVudC50cyIsIi4uLy4uLy4uLy4uLy4uLy4uL3Byb2plY3RzL2F1dGgtZmVhdHVyZXMvc3JjL2xpYi9wYWdlcy9mb3Jnb3QtcGFzc3dvcmQvZm9yZ290LXBhc3N3b3JkLmNvbXBvbmVudC5odG1sIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBRSxTQUFTLEVBQUUsTUFBTSxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBQ2xELE9BQU8sRUFBRSxXQUFXLEVBQUUsbUJBQW1CLEVBQUUsVUFBVSxFQUFFLE1BQU0sZ0JBQWdCLENBQUM7QUFDOUUsT0FBTyxFQUNMLFVBQVUsRUFDVixTQUFTLEVBQ1QsT0FBTyxFQUNQLE1BQU0sRUFDTixZQUFZLEVBQ1osU0FBUyxFQUNULFFBQVEsRUFDUixPQUFPLEVBQ1AsUUFBUSxFQUNSLFVBQVUsRUFDVixRQUFRLEdBQ1QsTUFBTSwyQkFBMkIsQ0FBQztBQUNuQyxPQUFPLEVBQUUsY0FBYyxFQUFFLE1BQU0scUNBQXFDLENBQUM7QUFDckUsT0FBTyxFQUFFLG1CQUFtQixFQUFFLE1BQU0sYUFBYSxDQUFDOzs7QUFzQmxELE1BQU0sT0FBTyx1QkFBdUI7SUFwQnBDO1FBcUJtQixVQUFLLEdBQUcsTUFBTSxDQUFDLG1CQUFtQixDQUFDLENBQUM7UUFDN0MsZ0JBQVcsR0FBRyxNQUFNLENBQUMsV0FBVyxDQUFDLENBQUM7UUFDMUMsVUFBSyxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUMsS0FBSyxDQUFDO1FBRXpCLGNBQVMsR0FBRyxJQUFJLENBQUMsV0FBVyxDQUFDLEtBQUssQ0FBQztZQUNqQyxLQUFLLEVBQUUsQ0FBQyxFQUFFLEVBQUUsQ0FBQyxVQUFVLENBQUMsUUFBUSxFQUFFLFVBQVUsQ0FBQyxLQUFLLENBQUMsQ0FBQztTQUNyRCxDQUFDLENBQUM7UUFDSCxhQUFRLEdBQUcsSUFBSSxDQUFDLFdBQVcsQ0FBQyxLQUFLLENBQUM7WUFDaEMsSUFBSSxFQUFFLENBQUMsRUFBRSxFQUFFLENBQUMsVUFBVSxDQUFDLFFBQVEsRUFBRSxVQUFVLENBQUMsU0FBUyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7U0FDM0QsQ0FBQyxDQUFDO1FBQ0gsdUJBQWtCLEdBQUcsSUFBSSxDQUFDLFdBQVcsQ0FBQyxLQUFLLENBQ3pDO1lBQ0UsV0FBVyxFQUFFLENBQUMsRUFBRSxFQUFFLENBQUMsVUFBVSxDQUFDLFFBQVEsRUFBRSxVQUFVLENBQUMsU0FBUyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7WUFDakUsZUFBZSxFQUFFLENBQUMsRUFBRSxFQUFFLENBQUMsVUFBVSxDQUFDLFFBQVEsQ0FBQyxDQUFDO1NBQzdDLEVBQ0Q7WUFDRSxVQUFVLEVBQUUsQ0FBQyxjQUFjLENBQUMsYUFBYSxFQUFFLGlCQUFpQixDQUFDLENBQUM7U0FDL0QsQ0FDRixDQUFDO0tBcUJIO0lBbkJDLG9CQUFvQjtRQUNsQixJQUFJLElBQUksQ0FBQyxTQUFTLENBQUMsS0FBSyxDQUFDLEtBQUs7WUFDNUIsSUFBSSxDQUFDLEtBQUssQ0FBQyxhQUFhLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxLQUFLLENBQUMsS0FBSyxDQUFDLENBQUM7SUFDekQsQ0FBQztJQUVELFVBQVU7UUFDUixJQUFJLElBQUksQ0FBQyxRQUFRLENBQUMsS0FBSyxDQUFDLElBQUk7WUFDMUIsSUFBSSxDQUFDLEtBQUssQ0FBQyxlQUFlLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLENBQUM7SUFDekQsQ0FBQztJQUVELGNBQWM7UUFDWixJQUNFLElBQUksQ0FBQyxrQkFBa0IsQ0FBQyxLQUFLO1lBQzdCLElBQUksQ0FBQyxrQkFBa0IsQ0FBQyxLQUFLLENBQUMsZUFBZTtZQUM3QyxDQUFDLElBQUksQ0FBQyxrQkFBa0IsQ0FBQyxRQUFRLENBQUMsVUFBVSxDQUFDO1lBRTdDLElBQUksQ0FBQyxLQUFLLENBQUMsY0FBYyxDQUFDLElBQUksQ0FBQyxrQkFBa0IsQ0FBQyxLQUFLLENBQUMsZUFBZSxDQUFDLENBQUM7SUFDN0UsQ0FBQztJQUNELGVBQWUsS0FBSSxDQUFDOytHQXZDVCx1QkFBdUI7bUdBQXZCLHVCQUF1QixrRkN0Q3BDLHE2RkFvR0EscVhEN0VJLFVBQVUsbUZBRVYsT0FBTywwTkFDUCxRQUFRLDhlQUNSLFNBQVMsb1BBQ1QsTUFBTSxvREFDTixPQUFPLGdGQUNQLFNBQVMsb0dBQ1QsVUFBVSx3S0FDVixZQUFZLHlEQUNaLG1CQUFtQjs7NEZBS1YsdUJBQXVCO2tCQXBCbkMsU0FBUzsrQkFDRSx3QkFBd0IsY0FDdEIsSUFBSSxXQUNQO3dCQUNQLFFBQVE7d0JBQ1IsVUFBVTt3QkFDVixRQUFRO3dCQUNSLE9BQU87d0JBQ1AsUUFBUTt3QkFDUixTQUFTO3dCQUNULE1BQU07d0JBQ04sT0FBTzt3QkFDUCxTQUFTO3dCQUNULFVBQVU7d0JBQ1YsWUFBWTt3QkFDWixtQkFBbUI7cUJBQ3BCIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQ29tcG9uZW50LCBpbmplY3QgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcclxuaW1wb3J0IHsgRm9ybUJ1aWxkZXIsIFJlYWN0aXZlRm9ybXNNb2R1bGUsIFZhbGlkYXRvcnMgfSBmcm9tICdAYW5ndWxhci9mb3Jtcyc7XHJcbmltcG9ydCB7XHJcbiAgSW9uQ29udGVudCxcclxuICBJb25IZWFkZXIsXHJcbiAgSW9uVGV4dCxcclxuICBJb25Sb3csXHJcbiAgSW9uVGh1bWJuYWlsLFxyXG4gIElvbkJ1dHRvbixcclxuICBJb25JbnB1dCxcclxuICBJb25JdGVtLFxyXG4gIElvbkxhYmVsLFxyXG4gIElvblRvb2xiYXIsXHJcbiAgSW9uVGl0bGUsXHJcbn0gZnJvbSAnQGlvbmljL2FuZ3VsYXIvc3RhbmRhbG9uZSc7XHJcbmltcG9ydCB7IG1hdGNoVmFsaWRhdG9yIH0gZnJvbSAnLi4vLi4vdmFsaWRhdG9ycy9tYXRjaGluZy52YWxpZGF0b3InO1xyXG5pbXBvcnQgeyBBdXRoZW50aWNhdGlvblN0b3JlIH0gZnJvbSAnLi4vLi4vc3RvcmUnO1xyXG5cclxuQENvbXBvbmVudCh7XHJcbiAgc2VsZWN0b3I6ICdjbG92aXMtZm9yZ290LXBhc3N3b3JkJyxcclxuICBzdGFuZGFsb25lOiB0cnVlLFxyXG4gIGltcG9ydHM6IFtcclxuICAgIElvblRpdGxlLFxyXG4gICAgSW9uVG9vbGJhcixcclxuICAgIElvbkxhYmVsLFxyXG4gICAgSW9uSXRlbSxcclxuICAgIElvbklucHV0LFxyXG4gICAgSW9uQnV0dG9uLFxyXG4gICAgSW9uUm93LFxyXG4gICAgSW9uVGV4dCxcclxuICAgIElvbkhlYWRlcixcclxuICAgIElvbkNvbnRlbnQsXHJcbiAgICBJb25UaHVtYm5haWwsXHJcbiAgICBSZWFjdGl2ZUZvcm1zTW9kdWxlLFxyXG4gIF0sXHJcbiAgdGVtcGxhdGVVcmw6ICcuL2ZvcmdvdC1wYXNzd29yZC5jb21wb25lbnQuaHRtbCcsXHJcbiAgc3R5bGVVcmw6ICcuL2ZvcmdvdC1wYXNzd29yZC5jb21wb25lbnQuc2NzcycsXHJcbn0pXHJcbmV4cG9ydCBjbGFzcyBGb3Jnb3RQYXNzd29yZENvbXBvbmVudCB7XHJcbiAgcHJpdmF0ZSByZWFkb25seSBzdG9yZSA9IGluamVjdChBdXRoZW50aWNhdGlvblN0b3JlKTtcclxuICBwcml2YXRlIGZvcm1CdWlsZGVyID0gaW5qZWN0KEZvcm1CdWlsZGVyKTtcclxuICBzdGVwcyA9IHRoaXMuc3RvcmUuc3RlcHM7XHJcblxyXG4gIGVtYWlsRm9ybSA9IHRoaXMuZm9ybUJ1aWxkZXIuZ3JvdXAoe1xyXG4gICAgZW1haWw6IFsnJywgW1ZhbGlkYXRvcnMucmVxdWlyZWQsIFZhbGlkYXRvcnMuZW1haWxdXSxcclxuICB9KTtcclxuICBjb2RlRm9ybSA9IHRoaXMuZm9ybUJ1aWxkZXIuZ3JvdXAoe1xyXG4gICAgY29kZTogWycnLCBbVmFsaWRhdG9ycy5yZXF1aXJlZCwgVmFsaWRhdG9ycy5taW5MZW5ndGgoNildXSxcclxuICB9KTtcclxuICB1cGRhdGVQYXNzd29yZEZvcm0gPSB0aGlzLmZvcm1CdWlsZGVyLmdyb3VwKFxyXG4gICAge1xyXG4gICAgICBuZXdQYXNzd29yZDogWycnLCBbVmFsaWRhdG9ycy5yZXF1aXJlZCwgVmFsaWRhdG9ycy5taW5MZW5ndGgoOCldXSxcclxuICAgICAgY29uZmlybVBhc3N3b3JkOiBbJycsIFtWYWxpZGF0b3JzLnJlcXVpcmVkXV0sXHJcbiAgICB9LFxyXG4gICAge1xyXG4gICAgICB2YWxpZGF0b3JzOiBbbWF0Y2hWYWxpZGF0b3IoJ25ld1Bhc3N3b3JkJywgJ2NvbmZpcm1QYXNzd29yZCcpXSxcclxuICAgIH1cclxuICApO1xyXG5cclxuICBzZW5kVmVyaWZpY2F0aW9uQ29kZSgpOiB2b2lkIHtcclxuICAgIGlmICh0aGlzLmVtYWlsRm9ybS52YWx1ZS5lbWFpbClcclxuICAgICAgdGhpcy5zdG9yZS5zZW5kUmVzZXRDb2RlKHRoaXMuZW1haWxGb3JtLnZhbHVlLmVtYWlsKTtcclxuICB9XHJcblxyXG4gIHZlcmlmeUNvZGUoKTogdm9pZCB7XHJcbiAgICBpZiAodGhpcy5jb2RlRm9ybS52YWx1ZS5jb2RlKVxyXG4gICAgICB0aGlzLnN0b3JlLnZlcmlmeVJlc2V0Q29kZSh0aGlzLmNvZGVGb3JtLnZhbHVlLmNvZGUpO1xyXG4gIH1cclxuXHJcbiAgdXBkYXRlUGFzc3dvcmQoKTogdm9pZCB7XHJcbiAgICBpZiAoXHJcbiAgICAgIHRoaXMudXBkYXRlUGFzc3dvcmRGb3JtLnZhbGlkICYmXHJcbiAgICAgIHRoaXMudXBkYXRlUGFzc3dvcmRGb3JtLnZhbHVlLmNvbmZpcm1QYXNzd29yZCAmJlxyXG4gICAgICAhdGhpcy51cGRhdGVQYXNzd29yZEZvcm0uaGFzRXJyb3IoJ21pc21hdGNoJylcclxuICAgIClcclxuICAgICAgdGhpcy5zdG9yZS51cGRhdGVQYXNzd29yZCh0aGlzLnVwZGF0ZVBhc3N3b3JkRm9ybS52YWx1ZS5jb25maXJtUGFzc3dvcmQpO1xyXG4gIH1cclxuICByZWRpcmVjdFRvTG9naW4oKSB7fVxyXG59XHJcbiIsIjxpb24taGVhZGVyIGNvbGxhcHNlPVwiZmFkZVwiPlxyXG4gIDxpb24tdG9vbGJhcj5cclxuICAgIDxpb24tcm93XHJcbiAgICAgIGNsYXNzPVwiaW9uLWp1c3RpZnktY29udGVudC1jZW50ZXIgaW9uLWFsaWduLWl0ZW1zLWNlbnRlciBpb24tdGV4dC1jZW50ZXJcIlxyXG4gICAgPlxyXG4gICAgICA8aW9uLXRodW1ibmFpbD5cclxuICAgICAgICA8aW1nXHJcbiAgICAgICAgICBhbHQ9XCJFbnZlbG9wcGVcIlxyXG4gICAgICAgICAgc3JjPVwiaHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vZHlld2hyMmxqL2ltYWdlL3VwbG9hZC92MTY2ODUxNjExMi9Mb2dvX0Nsb3Zpc19meHF5b2gucG5nXCJcclxuICAgICAgICAvPlxyXG4gICAgICA8L2lvbi10aHVtYm5haWw+XHJcbiAgICAgIDxwPmNsb3ZpczwvcD5cclxuICAgIDwvaW9uLXJvdz5cclxuICA8L2lvbi10b29sYmFyPlxyXG48L2lvbi1oZWFkZXI+XHJcblxyXG48aW9uLWNvbnRlbnQgY2xhc3M9XCJpb24tcGFkZGluZ1wiPlxyXG4gIEBzd2l0Y2ggKHN0ZXBzKCkpIHsgQGNhc2UgKDEpIHtcclxuICA8aW9uLXRleHQgY2xhc3M9XCJpb24tdGV4dC1jZW50ZXIgaW9uLW1hcmdpblwiPlxyXG4gICAgPGgzPlLDqWluaXRpYWxpc2F0aW9uIGRlIHZvdHJlIG1vdCBkZSBwYXNzZTwvaDM+XHJcbiAgICA8cD5Ob3VzIHZvdXMgZW52ZXJyb25zIHVuIGNvZGUgZGUgdsOpcmlmaWNhdGlvbiDDoCB2b3RyZSBhZHJlc3NlIGVtYWlsPC9wPlxyXG4gIDwvaW9uLXRleHQ+XHJcbiAgPGZvcm0gW2Zvcm1Hcm91cF09XCJlbWFpbEZvcm1cIiAobmdTdWJtaXQpPVwic2VuZFZlcmlmaWNhdGlvbkNvZGUoKVwiPlxyXG4gICAgPGlvbi1pdGVtPlxyXG4gICAgICA8aW9uLWlucHV0XHJcbiAgICAgICAgZmlsbD1cInNvbGlkXCJcclxuICAgICAgICBsYWJlbD1cIkVtYWlsXCJcclxuICAgICAgICBsYWJlbFBsYWNlbWVudD1cImZsb2F0aW5nXCJcclxuICAgICAgICBmb3JtQ29udHJvbE5hbWU9XCJlbWFpbFwiXHJcbiAgICAgICAgdHlwZT1cInRleHRcIlxyXG4gICAgICA+PC9pb24taW5wdXQ+XHJcbiAgICA8L2lvbi1pdGVtPlxyXG5cclxuICAgIDxpb24tYnV0dG9uXHJcbiAgICAgIGNsYXNzPVwiY2xvdmlzXCJcclxuICAgICAgW2Rpc2FibGVkXT1cImVtYWlsRm9ybS5pbnZhbGlkXCJcclxuICAgICAgZXhwYW5kPVwiYmxvY2tcIlxyXG4gICAgICB0eXBlPVwic3VibWl0XCJcclxuICAgICAgPkVudm95ZXIgbGUgY29kZSBkZSB2w6lyaWZpY2F0aW9uPC9pb24tYnV0dG9uXHJcbiAgICA+XHJcbiAgPC9mb3JtPlxyXG4gIH0gQGNhc2UgKDIpIHtcclxuICA8aW9uLXRleHQgY2xhc3M9XCJpb24tdGV4dC1jZW50ZXIgaW9uLW1hcmdpblwiPlxyXG4gICAgPGgzPlNhaXNpc3NleiBsZSBjb2RlIMOgIDYgY2hpZmZyZXMgcXVlIHZvdXMgYXZlYyByZcOndSBwYXIgZW1haWw8L2gzPlxyXG4gIDwvaW9uLXRleHQ+XHJcblxyXG4gIDxmb3JtIFtmb3JtR3JvdXBdPVwiY29kZUZvcm1cIiAobmdTdWJtaXQpPVwidmVyaWZ5Q29kZSgpXCI+XHJcbiAgICA8aW9uLWl0ZW0+XHJcbiAgICAgIDxpb24taW5wdXRcclxuICAgICAgICBmaWxsPVwic29saWRcIlxyXG4gICAgICAgIGxhYmVsPVwiQ29kZSBkZSBzw6ljdXJpdMOpXCJcclxuICAgICAgICBsYWJlbFBsYWNlbWVudD1cImZsb2F0aW5nXCJcclxuICAgICAgICBmb3JtQ29udHJvbE5hbWU9XCJjb2RlXCJcclxuICAgICAgICB0eXBlPVwicGFzc3dvcmRcIlxyXG4gICAgICA+PC9pb24taW5wdXQ+XHJcbiAgICA8L2lvbi1pdGVtPlxyXG5cclxuICAgIDxpb24tYnV0dG9uXHJcbiAgICAgIGNsYXNzPVwiY2xvdmlzXCJcclxuICAgICAgZXhwYW5kPVwiYmxvY2tcIlxyXG4gICAgICB0eXBlPVwic3VibWl0XCJcclxuICAgICAgW2Rpc2FibGVkXT1cImNvZGVGb3JtLmludmFsaWRcIlxyXG4gICAgICA+VmFsaWRlcjwvaW9uLWJ1dHRvblxyXG4gICAgPlxyXG4gIDwvZm9ybT5cclxuICB9IEBjYXNlICgzKSB7XHJcbiAgPGlvbi10ZXh0IGNsYXNzPVwiaW9uLXRleHQtY2VudGVyIGlvbi1tYXJnaW5cIj5cclxuICAgIDxoMz5QYXJmYWl0ICEgU2Fpc2lzc2V6IHZvdHJlIG5vdXZlYXUgbW90IGRlIHBhc3NlPC9oMz5cclxuICA8L2lvbi10ZXh0PlxyXG5cclxuICA8Zm9ybSBbZm9ybUdyb3VwXT1cInVwZGF0ZVBhc3N3b3JkRm9ybVwiIChuZ1N1Ym1pdCk9XCJ1cGRhdGVQYXNzd29yZCgpXCI+XHJcbiAgICA8aW9uLWl0ZW0+XHJcbiAgICAgIDxpb24taW5wdXRcclxuICAgICAgICBmaWxsPVwic29saWRcIlxyXG4gICAgICAgIGxhYmVsPVwiTm91dmVhdSBtb3QgZGUgcGFzc2VcIlxyXG4gICAgICAgIGxhYmVsUGxhY2VtZW50PVwiZmxvYXRpbmdcIlxyXG4gICAgICAgIGZvcm1Db250cm9sTmFtZT1cIm5ld1Bhc3N3b3JkXCJcclxuICAgICAgICB0eXBlPVwicGFzc3dvcmRcIlxyXG4gICAgICA+PC9pb24taW5wdXQ+XHJcbiAgICA8L2lvbi1pdGVtPlxyXG4gICAgPGlvbi1pdGVtPlxyXG4gICAgICA8aW9uLWlucHV0XHJcbiAgICAgICAgZmlsbD1cInNvbGlkXCJcclxuICAgICAgICBsYWJlbD1cIkNvbmZpcm1lciBsZSBtb3QgZGUgcGFzc2VcIlxyXG4gICAgICAgIGxhYmVsUGxhY2VtZW50PVwiZmxvYXRpbmdcIlxyXG4gICAgICAgIGZvcm1Db250cm9sTmFtZT1cImNvbmZpcm1QYXNzd29yZFwiXHJcbiAgICAgICAgdHlwZT1cInBhc3N3b3JkXCJcclxuICAgICAgPjwvaW9uLWlucHV0PlxyXG4gICAgPC9pb24taXRlbT5cclxuXHJcbiAgICA8aW9uLWJ1dHRvblxyXG4gICAgICBjbGFzcz1cImNsb3Zpc1wiXHJcbiAgICAgIGV4cGFuZD1cImJsb2NrXCJcclxuICAgICAgdHlwZT1cInN1Ym1pdFwiXHJcbiAgICAgIFtkaXNhYmxlZF09XCJ1cGRhdGVQYXNzd29yZEZvcm0uaW52YWxpZFwiXHJcbiAgICAgID5WYWxpZGVyPC9pb24tYnV0dG9uXHJcbiAgICA+XHJcbiAgPC9mb3JtPlxyXG4gIH0gfVxyXG48L2lvbi1jb250ZW50PlxyXG4iXX0=