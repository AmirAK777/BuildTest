{"version":3,"file":"auth-features-forgot-password.component-CX_ZMDrt.mjs","sources":["../../../projects/auth-features/src/lib/validators/matching.validator.ts","../../../projects/auth-features/src/lib/pages/forgot-password/forgot-password.component.ts","../../../projects/auth-features/src/lib/pages/forgot-password/forgot-password.component.html"],"sourcesContent":["import { AbstractControl, ValidationErrors, ValidatorFn } from '@angular/forms';\r\n\r\nexport function matchValidator(controlName: string, matchingControlName: string): ValidatorFn {\r\n  return (formGroup: AbstractControl): ValidationErrors | null => {\r\n    const control = formGroup.get(controlName);\r\n    const matchingControl = formGroup.get(matchingControlName);\r\n\r\n    if (!control || !matchingControl) {\r\n      return null;\r\n    }\r\n\r\n    if (matchingControl.errors && !matchingControl.errors['mustMatch']) {\r\n      return null;\r\n    }\r\n\r\n    if (control.value !== matchingControl.value) {\r\n      matchingControl.setErrors({ mustMatch: true });\r\n    } else {\r\n      matchingControl.setErrors(null);\r\n    }\r\n\r\n    return null;\r\n  };\r\n}","import { Component, inject } from '@angular/core';\r\nimport { FormBuilder, ReactiveFormsModule, Validators } from '@angular/forms';\r\nimport {\r\n  IonContent,\r\n  IonHeader,\r\n  IonText,\r\n  IonRow,\r\n  IonThumbnail,\r\n  IonButton,\r\n  IonInput,\r\n  IonItem,\r\n  IonLabel,\r\n  IonToolbar,\r\n  IonTitle,\r\n} from '@ionic/angular/standalone';\r\nimport { matchValidator } from '../../validators/matching.validator';\r\nimport { AuthenticationStore } from '../../store';\r\n\r\n@Component({\r\n  selector: 'clovis-forgot-password',\r\n  standalone: true,\r\n  imports: [\r\n    IonTitle,\r\n    IonToolbar,\r\n    IonLabel,\r\n    IonItem,\r\n    IonInput,\r\n    IonButton,\r\n    IonRow,\r\n    IonText,\r\n    IonHeader,\r\n    IonContent,\r\n    IonThumbnail,\r\n    ReactiveFormsModule,\r\n  ],\r\n  templateUrl: './forgot-password.component.html',\r\n  styleUrl: './forgot-password.component.scss',\r\n})\r\nexport class ForgotPasswordComponent {\r\n  private readonly store = inject(AuthenticationStore);\r\n  private formBuilder = inject(FormBuilder);\r\n  steps = this.store.steps;\r\n\r\n  emailForm = this.formBuilder.group({\r\n    email: ['', [Validators.required, Validators.email]],\r\n  });\r\n  codeForm = this.formBuilder.group({\r\n    code: ['', [Validators.required, Validators.minLength(6)]],\r\n  });\r\n  updatePasswordForm = this.formBuilder.group(\r\n    {\r\n      newPassword: ['', [Validators.required, Validators.minLength(8)]],\r\n      confirmPassword: ['', [Validators.required]],\r\n    },\r\n    {\r\n      validators: [matchValidator('newPassword', 'confirmPassword')],\r\n    }\r\n  );\r\n\r\n  sendVerificationCode(): void {\r\n    if (this.emailForm.value.email)\r\n      this.store.sendResetCode(this.emailForm.value.email);\r\n  }\r\n\r\n  verifyCode(): void {\r\n    if (this.codeForm.value.code)\r\n      this.store.verifyResetCode(this.codeForm.value.code);\r\n  }\r\n\r\n  updatePassword(): void {\r\n    if (\r\n      this.updatePasswordForm.valid &&\r\n      this.updatePasswordForm.value.confirmPassword &&\r\n      !this.updatePasswordForm.hasError('mismatch')\r\n    )\r\n      this.store.updatePassword(this.updatePasswordForm.value.confirmPassword);\r\n  }\r\n  redirectToLogin() {}\r\n}\r\n","<ion-header collapse=\"fade\">\r\n  <ion-toolbar>\r\n    <ion-row\r\n      class=\"ion-justify-content-center ion-align-items-center ion-text-center\"\r\n    >\r\n      <ion-thumbnail>\r\n        <img\r\n          alt=\"Enveloppe\"\r\n          src=\"https://res.cloudinary.com/dyewhr2lj/image/upload/v1668516112/Logo_Clovis_fxqyoh.png\"\r\n        />\r\n      </ion-thumbnail>\r\n      <p>clovis</p>\r\n    </ion-row>\r\n  </ion-toolbar>\r\n</ion-header>\r\n\r\n<ion-content class=\"ion-padding\">\r\n  @switch (steps()) { @case (1) {\r\n  <ion-text class=\"ion-text-center ion-margin\">\r\n    <h3>Réinitialisation de votre mot de passe</h3>\r\n    <p>Nous vous enverrons un code de vérification à votre adresse email</p>\r\n  </ion-text>\r\n  <form [formGroup]=\"emailForm\" (ngSubmit)=\"sendVerificationCode()\">\r\n    <ion-item>\r\n      <ion-input\r\n        fill=\"solid\"\r\n        label=\"Email\"\r\n        labelPlacement=\"floating\"\r\n        formControlName=\"email\"\r\n        type=\"text\"\r\n      ></ion-input>\r\n    </ion-item>\r\n\r\n    <ion-button\r\n      class=\"clovis\"\r\n      [disabled]=\"emailForm.invalid\"\r\n      expand=\"block\"\r\n      type=\"submit\"\r\n      >Envoyer le code de vérification</ion-button\r\n    >\r\n  </form>\r\n  } @case (2) {\r\n  <ion-text class=\"ion-text-center ion-margin\">\r\n    <h3>Saisissez le code à 6 chiffres que vous avec reçu par email</h3>\r\n  </ion-text>\r\n\r\n  <form [formGroup]=\"codeForm\" (ngSubmit)=\"verifyCode()\">\r\n    <ion-item>\r\n      <ion-input\r\n        fill=\"solid\"\r\n        label=\"Code de sécurité\"\r\n        labelPlacement=\"floating\"\r\n        formControlName=\"code\"\r\n        type=\"password\"\r\n      ></ion-input>\r\n    </ion-item>\r\n\r\n    <ion-button\r\n      class=\"clovis\"\r\n      expand=\"block\"\r\n      type=\"submit\"\r\n      [disabled]=\"codeForm.invalid\"\r\n      >Valider</ion-button\r\n    >\r\n  </form>\r\n  } @case (3) {\r\n  <ion-text class=\"ion-text-center ion-margin\">\r\n    <h3>Parfait ! Saisissez votre nouveau mot de passe</h3>\r\n  </ion-text>\r\n\r\n  <form [formGroup]=\"updatePasswordForm\" (ngSubmit)=\"updatePassword()\">\r\n    <ion-item>\r\n      <ion-input\r\n        fill=\"solid\"\r\n        label=\"Nouveau mot de passe\"\r\n        labelPlacement=\"floating\"\r\n        formControlName=\"newPassword\"\r\n        type=\"password\"\r\n      ></ion-input>\r\n    </ion-item>\r\n    <ion-item>\r\n      <ion-input\r\n        fill=\"solid\"\r\n        label=\"Confirmer le mot de passe\"\r\n        labelPlacement=\"floating\"\r\n        formControlName=\"confirmPassword\"\r\n        type=\"password\"\r\n      ></ion-input>\r\n    </ion-item>\r\n\r\n    <ion-button\r\n      class=\"clovis\"\r\n      expand=\"block\"\r\n      type=\"submit\"\r\n      [disabled]=\"updatePasswordForm.invalid\"\r\n      >Valider</ion-button\r\n    >\r\n  </form>\r\n  } }\r\n</ion-content>\r\n"],"names":[],"mappings":"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"}