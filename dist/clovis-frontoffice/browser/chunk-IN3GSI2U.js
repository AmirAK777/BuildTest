import{a as i,c as I,d as w,f as _,g as T,h as d,i as p,j as B,l as L,n as b,s as y}from"./chunk-FWA4ZV65.js";import{$b as $,A as f,Da as C,E as m,La as k,Na as U,Sa as j,b as a,o as u,v as x,x as l}from"./chunk-J4QSXUO7.js";import{a as h,b as g}from"./chunk-KZZABCGY.js";var S={production:!1,apiURL:"http://staging.mysite.com/api"};var W=(()=>{class e{constructor(){this.httpClient=m(U),this.baseUrl=S.apiURL+"customer"}loadCurrentCustomer(){let t=new k({"Content-Type":"application/x-www-form-urlencoded"});return console.log("methode LoadCurrentcustomer est declench\xE9"),this.customer$=this.httpClient.get("http://192.168.1.38:5000/customer",{headers:t}).pipe(x(1)),this.customer$}updateCurrentCustomer(t){return this.customer$=this.httpClient.put(`${this.baseUrl}/`,t)}createBankUser(){return this.httpClient.post(`${this.baseUrl}/bank/user`,{})}getBankWidget(t=!1,r=!1,s=!1,o=!0,n=!0){if(!this.widgets$){let P={withCallbackUri:t,withRedrectUrl:r,withCancelUrl:s,withCountries:o,withLocale:n};this.widgets$=this.httpClient.post(`${this.baseUrl}/bank/widget/widget_session`,P)}return this.widgets$}updateAddress(t){return this.httpClient.put(`${this.baseUrl}/address`,t)}updateContactDetails(t){return this.httpClient.put(`${this.baseUrl}/contact-details`,t)}updateFamilySituation(t){return this.httpClient.put(`${this.baseUrl}/family-situation`,t)}updateFinancialSituation(t){return this.httpClient.put(`${this.baseUrl}/financial-situation`,t)}updateIdentity(t){return this.httpClient.put(`${this.baseUrl}/identity`,t)}updateObjectifs(t){return this.httpClient.put(`${this.baseUrl}/objectifs`,t)}updateTaxationSituation(t){return this.httpClient.put(`${this.baseUrl}/taxation-situation`,t)}updateProfessionalSituation(t){return this.httpClient.put(`${this.baseUrl}/profesional-situation`,t)}static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275prov=f({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();var M=(()=>{class e{constructor(){this._toastController=m($),B({checkmarkCircleOutline:b,alertCircleOutline:L,reloadCircleOutline:y})}async presentToastWithOptions(t,r,s){await(await this._toastController.create({message:t,duration:2500,position:"bottom",icon:r,color:s})).present()}success(t){this.presentToastWithOptions(t,b,"primary")}loading(t){this.presentToastWithOptions(t,y,"secondary")}warning(t){this.presentToastWithOptions(t,L,"warning")}error(t){this.presentToastWithOptions(t,L,"danger")}static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275prov=f({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();var R={customer:{id:"",roles:[],firstName:"",lastName:"",email:"",address:{street:null,zipCode:null,city:null,country:null},contactDetails:{email:null,phoneNumber:null},familySituation:{children:null,dependents:null,maritalSituation:"Singled",legalProtection:null},financialSituation:{salaryIncome:null,passiveIncome:null,charges:null,monthlySaving:null,saving:null,rent:null,taxPerYear:null,withHoldingTax:null,disposableIncome:null,borrowingCapacity:null},identity:{title:null,firstName:"null",lastName:"null",birthDate:null,birthCountry:null,birthCity:null,birthRegion:null},objectifs:{reduceTax:null,prepareRetirement:null,generatePassiveIncome:null,realEstate:null,optimizeDeclaration:null},taxationSituation:{nationality:null,principalTaxResidence:null,taxResidenceInAnotherCountry:null,isHouseholdSubjectToIncomeTax:null,haveAmericainNationality:null,haveNoEuropeenTaxResidence:null},professionalSituation:{professionnalStatus:null,job:null,socioProfessionalCategory:null,industrySector:null,isPolitical:null,anyRelativeIsPolitical:null},bank:{linxoId:null},offers:null},widgetBankLinks:{session_id:null,_links:{add_connection:null,manage_connections:""}},isLoading:!1},F=I({providedIn:"root"},T(R),w(e=>({isLoggedIn:C(()=>e.customer()!=null),isLinxoId:C(()=>e.customer().bank!=null),isWidget:C(()=>e.widgetBankLinks()?._links?.add_connection!=null),isHaveOffers:C(()=>e.customer()?.offers?.length!==0)})),_((e,c=m(W),t=m(j),r=m(M))=>({getCurrentCustomer:d(a(l(()=>i(e,{isLoading:!0})),u(s=>c.loadCurrentCustomer().pipe(p({next:o=>{console.log("customer",o),i(e,{isLoading:!1,customer:o})},error:()=>{i(e,{isLoading:!1})}}))))),updateCurrentCustomer:d(a(l(()=>i(e,{isLoading:!0})),u(s=>c.updateCurrentCustomer(s).pipe(p({next:o=>{i(e,{isLoading:!1,customer:s})},error:()=>{i(e,{isLoading:!1})}}))))),createBankUser:d(a(l(()=>i(e,{isLoading:!0})),u(()=>c.createBankUser().pipe(p({next:()=>{console.log("create back User"),i(e,{isLoading:!1}),r.success("Succes")},error:()=>{console.log("create back fail"),i(e,{isLoading:!1}),r.error("Erreur de cr\xE9ation")}}))))),getBankWidget:d(a(l(()=>i(e,{isLoading:!0})),u(s=>c.getBankWidget(s.withCallbackUri,s.withCallbackUri).pipe(p({next:o=>{console.log("create widget User"),i(e,{widgetBankLinks:o,isLoading:!1}),r.loading("Merci de patienter pendant le chargement du formulaire.")},error:()=>{i(e,{isLoading:!1}),r.error("Erreur de cr\xE9ation")}}))))),updateAdress:d(a(l(()=>i(e,{isLoading:!0})),u(s=>c.updateAddress(s).pipe(p({next:o=>{i(e,n=>({customer:g(h({},n.customer),{address:s}),isLoading:!1})),r.success("Mise \xE0 jour reussi")},error:()=>{i(e,{isLoading:!1}),r.error("Une erreur s'est produite lors de la mise \xE0 jour.")}}))))),updateContactDetails:d(a(l(()=>i(e,{isLoading:!0})),u(s=>c.updateContactDetails(s).pipe(p({next:o=>{i(e,n=>({customer:g(h({},n.customer),{contactDetails:s}),isLoading:!1})),r.success("Mise \xE0 jour reussi")},error:()=>{i(e,{isLoading:!1}),r.error("Une erreur s'est produite lors de la mise \xE0 jour.")}}))))),updateFamilySituation:d(a(l(()=>i(e,{isLoading:!0})),u(s=>c.updateFamilySituation(s).pipe(p({next:o=>{i(e,n=>({customer:g(h({},n.customer),{familySituation:s}),isLoading:!1})),r.success("Mise \xE0 jour reussi")},error:()=>{i(e,{isLoading:!1}),r.error("Une erreur s'est produite lors de la mise \xE0 jour.")}}))))),updateFinancialSituation:d(a(l(()=>i(e,{isLoading:!0})),u(s=>c.updateFinancialSituation(s).pipe(p({next:o=>{i(e,n=>({customer:g(h({},n.customer),{financialSituation:s}),isLoading:!1})),r.success("Mise \xE0 jour reussi")},error:()=>{i(e,{isLoading:!1}),r.error("Une erreur s'est produite lors de la mise \xE0 jour.")}}))))),updateIdentity:d(a(l(()=>i(e,{isLoading:!0})),u(s=>c.updateIdentity(s).pipe(p({next:o=>{i(e,n=>({customer:g(h({},n.customer),{identity:s}),isLoading:!1})),r.success("Mise \xE0 jour reussi")},error:()=>{i(e,{isLoading:!1}),r.error("Une erreur s'est produite lors de la mise \xE0 jour.")}}))))),updateObjectifs:d(a(l(()=>i(e,{isLoading:!0})),u(s=>c.updateObjectifs(s).pipe(p({next:o=>{i(e,n=>({customer:g(h({},n.customer),{objectifs:s}),isLoading:!1})),r.success("Mise \xE0 jour reussi")},error:()=>{i(e,{isLoading:!1}),r.error("Une erreur s'est produite lors de la mise \xE0 jour.")}}))))),updateTaxationSituation:d(a(l(()=>i(e,{isLoading:!0})),u(s=>c.updateTaxationSituation(s).pipe(p({next:o=>{i(e,n=>({customer:g(h({},n.customer),{taxationSituation:s}),isLoading:!1})),r.success("Mise \xE0 jour reussi")},error:()=>{i(e,{isLoading:!1}),r.error("Une erreur s'est produite lors de la mise \xE0 jour.")}}))))),updateProfessionalSituation:d(a(l(()=>i(e,{isLoading:!0})),u(s=>c.updateProfessionalSituation(s).pipe(p({next:o=>{i(e,n=>({customer:g(h({},n.customer),{professionalSituation:s}),isLoading:!1})),r.success("Mise \xE0 jour reussi")},error:()=>{i(e,{isLoading:!1}),r.error("Une erreur s'est produite lors de la mise \xE0 jour.")}})))))})));var de=(()=>{class e{constructor(){this._store=m(F)}getCurrentCustomer(){this._store.getCurrentCustomer()}createBankUser(){this._store.createBankUser()}getBankWidget(t,r){this._store.getBankWidget({withCallbackUri:t,withRedrectUrl:r})}updateCurrentCustomer(t){this._store.updateCurrentCustomer(t)}updateIdentity(t){this._store.updateIdentity(t)}updateTaxationSituation(t){this._store.updateTaxationSituation(t)}updateFamilySituation(t){this._store.updateFamilySituation(t)}updateProfessionalSituation(t){this._store.updateProfessionalSituation(t)}updateContactDetails(t){this._store.updateContactDetails(t)}updateAddress(t){this._store.updateAdress(t)}getInitials(t,r){return!t||!r?"":t.charAt(0).toUpperCase()+r.charAt(0).toUpperCase()}get isLoading(){return this._store.isLoading}get isLoggedIn(){return this._store.isLoggedIn}get isLinxoId(){return this._store.isLinxoId}get isWidget(){return this._store.isWidget}get isHaveOffer(){return this._store.isHaveOffers}get customer(){return this._store.customer}get widgetBankLinks(){return this._store.widgetBankLinks}static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275prov=f({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();export{F as a,de as b};
